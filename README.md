# Архитектура высоконагруженных система. ДЗ №8

## Цель:
> 1. Засетапить kafka-кластер из 3-х брокеров (*lxc, docker, etc.*)
> 2. Создать 2 топика с фактором репликации 3
>	- Первый топик для общения 2-х программ
>	- Второй топик для dead letter
> 3. Написать 2 программы на любом языке (не обязательно на разных)
>	- Первая программа посылает в первый топик сообщения
>	- Вторая программа вычитывает из топика сообщения
> 4. Реализовать отправку сообщений 2-х видов из первой программы
>	- Первый вид json `json {"type": "message"}`
>	- Второй вид json `json {"type": "error"}`
> 5. Реализовать следующее поведение второй программы
>	- Если вычитанное сообщение `json {"type": "message"}`, то в консоль пишется "Done!"
>	- Если вычитанное сообщение **НЕ** `json {"type": "message"}`, то оно помещается в dead letter

--------------





--------------

## Инструкция по установке:
1. Скачать/стянуть репозиторий
1. Перейти в папку репозитория
1. На серврере, где будет расположен kafka-кластер выполнить следующую команду:
	```bash
	git clone https://github.com/wurstmeister/kafka-docker.git
	cp docker-compose.yml ./kafka-docker
	cd kafka-docker
	docker-compose up -d zookeeper
	docker-compose scale kafka=3
	```
1. Перед запуском приложений необходимо убедиться, что в коде правильно указан порт, ну а чтобы его узнать, необходимо на сервере выполнить команду `docker ps -a` и обнаружить порт у интересующего нас докер-контейнера
1. Далее запустить в одном терминале первое приложение (producer) командой `python3 app1.py`
1. И запустить второе приложение (consumer) командой `python3 app2.py` в другом терминале
1. Пользоваться первым приложением, согласно инструкции и наблюдать результаты Ваших действий во втором приложении

1. По завершении остановить *docker-compose* выполнением команды на сервере:
	```bash
	docker-compose down
	```

## Инструментарий:
- GIT (устанавливается командой `sudo apt install git -y`)
- Установленные модули:
	+ kafka-python (устанавливается командой `sudo pip3 install kafka-python`)


## Почитать:
- [полезности из Wiki разработчиков kafka-docker](https://github.com/wurstmeister/kafka-docker)